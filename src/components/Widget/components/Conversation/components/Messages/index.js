import React, { Component } from 'react';
import PropTypes from 'prop-types';
import ImmutablePropTypes from 'react-immutable-proptypes';
import { connect } from 'react-redux';

import { MESSAGES_TYPES } from 'constants';
import { Video, Image, Message, Carousel, Buttons } from 'messagesComponents';

import './styles.scss';
import ThemeContext from '../../../../ThemeContext';

const isToday = (date) => {
  const today = new Date();
  return date.getDate() === today.getDate() &&
    date.getMonth() === today.getMonth() &&
    date.getFullYear() === today.getFullYear();
};

const formatDate = (date) => {
  const dateToFormat = new Date(date);
  const showDate = isToday(dateToFormat) ? '' : `${dateToFormat.toLocaleDateString()} `;
  return `${showDate}${dateToFormat.toLocaleTimeString('en-US', { timeStyle: 'short' })}`;
};

const scrollToBottom = () => {
  const messagesDiv = document.getElementById('rw-messages');
  if (messagesDiv) {
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }
};

class Messages extends Component {
  componentDidMount() {
    scrollToBottom();
  }

  componentDidUpdate() {
    scrollToBottom();
  }

  getComponentToRender = (message, index, isLast) => {
    const { params } = this.props;
    const ComponentToRender = (() => {
      switch (message.get('type')) {
        case MESSAGES_TYPES.TEXT: {
          return Message;
        }
        case MESSAGES_TYPES.CAROUSEL: {
          return Carousel;
        }
        case MESSAGES_TYPES.VIDREPLY.VIDEO: {
          return Video;
        }
        case MESSAGES_TYPES.IMGREPLY.IMAGE: {
          return Image;
        }
        case MESSAGES_TYPES.BUTTONS: {
          return Buttons;
        }
        case MESSAGES_TYPES.CUSTOM_COMPONENT:
          return connect(
            store => ({ store }),
            dispatch => ({ dispatch })
          )(this.props.customComponent);
        default:
          return null;
      }
    })();
    if (message.get('type') === 'component') {
      return <ComponentToRender id={index} {...message.get('props')} isLast={isLast} />;
    }
    return <ComponentToRender id={index} params={params} message={message} isLast={isLast} />;
  }

  render() {
    const { displayTypingIndication, profileAvatar } = this.props;

    const renderMessages = () => {
      const {
        messages,
        showMessageDate
      } = this.props;

      if (messages.isEmpty()) return null;

      const groups = [];
      let group = null;

      const dateRenderer = typeof showMessageDate === 'function' ? showMessageDate :
        showMessageDate === true ? formatDate : null;

      const renderMessageDate = (message) => {
        const timestamp = message.get('timestamp');

        if (!dateRenderer || !timestamp) return null;
        const dateToRender = dateRenderer(message.get('timestamp', message));
        return dateToRender
          ? <span className="rw-message-date">{dateRenderer(message.get('timestamp'), message)}</span>
          : null;
      };

      const renderMessage = (message, index) => (
        <div className={`rw-message ${profileAvatar && 'rw-with-avatar'}`} key={index}>
          {
            profileAvatar &&
            message.get('showAvatar') &&
            <img src={profileAvatar} className="rw-avatar" alt="profile" />
          }
          {this.getComponentToRender(message, index, index === messages.size - 1)}
          {renderMessageDate(message)}
        </div>
      );

      messages.forEach((msg, index) => {
        if (msg.get('hidden')) return;
        if (group === null || group.from !== msg.get('sender')) {
          if (group !== null) groups.push(group);

          group = {
            from: msg.get('sender'),
            messages: []
          };
        }

        group.messages.push(renderMessage(msg, index));
      });
      

      groups.push(group); // finally push last group of messages.

      let lastMessage = [groups.pop()]
      
      return lastMessage.map((g, index) => (
        <div className={`rw-group-message rw-from-${g && g.from}`} key={`group_${index}`}>
          {g.messages}
        </div>
      ));
    };

    const { conversationBackgroundColor, assistBackgoundColor } = this.context;

    return (
      <div id="rw-messages" style={{ backgroundColor: conversationBackgroundColor }} className="rw-messages-container">
        {!displayTypingIndication && renderMessages() }
        {displayTypingIndication && (
          <div className={`rw-message rw-typing-indication ${profileAvatar && 'rw-with-avatar'}`}>
            <svg width="151" height="59" viewBox="0 0 151 59" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
              <rect width="151" height="58.9362" fill="url(#pattern0)"/>
              <defs>
              <pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1">
              <use xlink:href="#image0" transform="scale(0.00127551 0.00326797)"/>
              </pattern>
              <image id="image0" width="784" height="306" xlink:href="data:image/png;base64,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"/>
              </defs>
            </svg>
          </div>
        )}
        {/* {displayTypingIndication && (
          <div className={`rw-message rw-typing-indication ${profileAvatar && 'rw-with-avatar'}`}>
            {
              profileAvatar &&
              <img src={profileAvatar} className="rw-avatar" alt="profile" />
            }
            <div style={{ backgroundColor: assistBackgoundColor }} className="rw-response">
              <div id="wave">
                <span className="rw-dot" />
                <span className="rw-dot" />
                <span className="rw-dot" />
              </div>
            </div>
          </div>
        )} */}
      </div>
    );
  }
}
Messages.contextType = ThemeContext;
Messages.propTypes = {
  messages: ImmutablePropTypes.listOf(ImmutablePropTypes.map),
  profileAvatar: PropTypes.string,
  customComponent: PropTypes.func,
  showMessageDate: PropTypes.oneOfType([PropTypes.bool, PropTypes.func]),
  displayTypingIndication: PropTypes.bool
};

Message.defaultTypes = {
  displayTypingIndication: false
};

export default connect(store => ({
  messages: store.messages,
  displayTypingIndication: store.behavior.get('messageDelayed')
}))(Messages);
